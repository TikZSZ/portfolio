import{d as g,E as T,G as _,u as f,_ as y,o as a,c as r,a as u,g as s,H as h,I as m,J as C,F as P,r as d,B as E,C as k,f as B,b,z as U}from"./index.22295eb8.js";import{P as x}from"./Post.9f83cc6d.js";import{E as V,_ as S}from"./Editor.f38d5f1b.js";import{p}from"./postApi.5e326f0e.js";const I=g({components:{EditorVue:V,ErrorVue:T},data(){return{content:"",blogTitle:"",blogDes:"",submitDisabled:!1,editDisabled:!1}},setup(){const t=_("Please wait...");return{store:f(),...t}},props:{post:{type:Object,required:!0}},async mounted(){const{name:t,description:e}=this.post;this.blogTitle=t,this.blogDes=e,this.fetchContent()},watch:{post(t){const{name:e,description:o}=t;this.blogTitle=e,this.blogDes=o,this.fetchContent()}},emits:{postMetadataUpdated:(t,e)=>!0},methods:{async editContent(){this.editDisabled=!0,await p.post("/editContent",{data:{contentId:this.$props.post.content,content:this.content}}),this.editDisabled=!1},contentUpdated(t){this.content=t},async editPost(){this.handleSubmit("Please wait...");const t=this.$props.post,e=this.blogTitle,o=this.blogDes;try{const n=await p.post("/editPost",{data:{postId:this.post.id,postName:e,postDescription:o}});console.log(n),this.handleSuccess("Success!"),this.$emit("postMetadataUpdated",t.id,{name:e,description:o})}catch{this.handleError("Something went wrong! Please try again later")}},async fetchContent(){const{data:t}=await p.get(`/content/${this.post.content}`);this.content=t.content}}}),A={class:"py-10 card bg-base-300"},N={class:"form-control"},F=s("label",{class:"label"},[s("span",{class:"label-text text-secondary"},"Name")],-1),L={class:"form-control"},j=s("label",{class:"label"},[s("span",{class:"label-text text-secondary"},"Description")],-1),z=["disabled"],H=s("h1",{class:"text-center font-mono text-4xl my-10 text-neutral-content"}," Text Editor ",-1),G=["disabled"];function O(t,e,o,n,v,w){const c=d("ErrorVue"),i=d("EditorVue");return a(),r(P,null,[u(c,{variant:t.variant,show:t.show,style:"rounded mt-8",textMsg:t.textMsg},null,8,["variant","show","textMsg"]),s("form",{onSubmit:e[2]||(e[2]=C((...l)=>t.editPost&&t.editPost(...l),["prevent"])),id:"content"},[s("div",A,[s("div",N,[F,h(s("input",{type:"text",placeholder:"Post title",class:"input text-secondary-content","onUpdate:modelValue":e[0]||(e[0]=l=>t.blogTitle=l)},null,512),[[m,t.blogTitle]])]),s("div",L,[j,h(s("input",{type:"text",placeholder:"Post description","onUpdate:modelValue":e[1]||(e[1]=l=>t.blogDes=l),class:"input text-secondary-content"},null,512),[[m,t.blogDes]])]),s("button",{type:"submit",disabled:t.submitDisabled,class:"btn btn-primary mt-5"}," Submit ",8,z)])],32),H,u(i,{content:t.content,onContentUpdated:t.contentUpdated},null,8,["content","onContentUpdated"]),s("button",{class:"btn btn-secondary mt-5 ml-3",onClick:e[3]||(e[3]=(...l)=>t.editContent&&t.editContent(...l)),disabled:t.editDisabled}," Edit Blog ",8,G)],64)}var Y=y(I,[["render",O]]);const q=g({components:{EditorVue:V,ErrorVue:T},data(){return{content:"<p>Hello, World</p>",blogTitle:"My First Post",blogDes:"Post description",submitDisabled:!1,editDisabled:!1,post:null}},setup(){const t=_("Creating...");return{store:f(),...t}},emits:{postAdded:t=>!0,changeTab:t=>!0},methods:{async savePostMetadata(){this.handleSubmit("Creating...");const t=this.blogTitle,e=this.blogDes;try{const{data:o}=await p.post("/createPost",{data:{postName:t,postDescription:e}});this.handleSuccess("Post Created"),this.post=o,this.$emit("postAdded",o),this.resetForm()}catch(o){console.log(o),this.handleError("Something went wrong! Please try again")}},resetForm(){this.blogTitle="",this.blogDes="",this.$emit("changeTab",1)}}}),J=s("div",{class:"flex text-info mx-4 md:mx-0 mt-8"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"w-10 h-12 md:w-6 md:h-6 mx-2 stroke-current"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("label",{class:"md:text-lg"},"You must first Submit Post Information and then you can edit the post in Edit Post")],-1),R={class:"py-5 card"},W={class:"form-control"},K=s("label",{class:"label"},[s("span",{class:"label-text text-secondary"},"Name")],-1),Q={class:"form-control"},X=s("label",{class:"label"},[s("span",{class:"label-text text-secondary"},"Description")],-1),Z=["disabled"];function tt(t,e,o,n,v,w){const c=d("ErrorVue");return a(),r(P,null,[J,u(c,{variant:t.variant,show:t.show,style:"rounded",textMsg:t.textMsg},null,8,["variant","show","textMsg"]),s("form",{onSubmit:e[2]||(e[2]=C((...i)=>t.savePostMetadata&&t.savePostMetadata(...i),["prevent"]))},[s("div",R,[s("div",W,[K,h(s("input",{type:"text",placeholder:"Post title",class:"input text-secondary-content","onUpdate:modelValue":e[0]||(e[0]=i=>t.blogTitle=i)},null,512),[[m,t.blogTitle]])]),s("div",Q,[X,h(s("input",{type:"text",placeholder:"Post description","onUpdate:modelValue":e[1]||(e[1]=i=>t.blogDes=i),class:"input text-secondary-content"},null,512),[[m,t.blogDes]])]),s("button",{type:"submit",disabled:t.submitDisabled,class:"btn btn-primary mt-5"}," Submit Post Info ",8,Z)])],32)],64)}var et=y(q,[["render",tt]]);const st=g({name:"Dashboard",components:{PostVue:x,TabMenuVue:S,EditBlogVue:Y,CreateBlogVue:et},data(){return{posts:[],currentTab:1,selectedPost:null}},async created(){if(this.posts.length===0){const{data:t}=await E.get(`${k}/blog/userPosts`,{withCredentials:!0});this.posts=t,this.selectedPost=this.posts[0],console.log(t)}},methods:{changeTab(t){this.currentTab=t,t===1&&this.selectPost(0)},selectPost(t){var e;this.selectedPost=this.posts[t],this.currentTab=1,(e=document.getElementById("content"))==null||e.scrollIntoView()},postAdded(t){this.posts.unshift(t)},postMetadataUpdated(t,e){console.log(t,e),this.posts.map((o,n)=>{o.id===t&&(this.posts[n]={...this.posts[n],...e})})},selectLatestPost(){this.selectedPost=this.posts[0],this.currentTab=1}},async beforeRouteEnter(t,e,o){const n=f();await n.checkLogin(),n.isLoggedIn?o():o({name:"Home"})}}),ot={class:"px-5 md:px-10 bg-base-300 pt-3 text-primary"},nt={key:0},at={key:1,class:"alert alert-info"},it=s("div",{class:"flex-1"},[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",class:"h-20 w-20 md:w-12 md:h-12 lg:w-6 lg:h-6 mx-2 stroke-current"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})]),s("label",null,"You haven't posted anything yet! Once u have made posts they will appear here for editing. Get started by visting Create Post")],-1),lt=[it],rt={key:1};function dt(t,e,o,n,v,w){const c=d("TabMenuVue"),i=d("PostVue"),l=d("EditBlogVue"),D=d("CreateBlogVue");return a(),r("div",ot,[u(c,{class:"my-5",currentTab:t.currentTab,b1:"Edit Post",b2:"Create Post",onChangeTab:t.changeTab},null,8,["currentTab","onChangeTab"]),s("div",null,[t.currentTab===1?(a(),r("div",nt,[(a(!0),r(P,null,B(t.posts,(M,$)=>(a(),b(i,{post:M,postIndex:$,postClick:()=>t.selectPost($)},null,8,["post","postIndex","postClick"]))),256)),t.selectedPost?(a(),b(l,{key:0,post:t.selectedPost,onPostMetadataUpdated:t.postMetadataUpdated},null,8,["post","onPostMetadataUpdated"])):(a(),r("div",at,lt))])):(a(),r("div",rt,[t.currentTab===2?(a(),b(D,{key:0,onPostAdded:t.postAdded,onChangeTab:t.changeTab},null,8,["onPostAdded","onChangeTab"])):U("",!0)]))])])}var mt=y(st,[["render",dt]]);export{mt as default};
